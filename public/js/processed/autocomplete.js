function addItemAutocompleteHandler(){$(".js-item-autocomplete").each(function(){var t=this;$(this).autocomplete({source:function source(e,n){$.ajax({method:"get",dataType:"json",url:"/api/items/query/"+expansionId+"/"+e.term,success:function success(a){n(a),a.length<=0&&($(t).nextAll(".js-status-indicator").show(),$(t).nextAll(".js-status-indicator").html('<span class="bg-danger">&nbsp;'+e.term+" not found&nbsp;</span>"))},error:function error(){}})},search:function search(){$(this).nextAll(".js-status-indicator").hide(),$(this).nextAll(".js-status-indicator").empty(),$(this).nextAll(".js-loading-indicator").show()},response:function response(){$(this).nextAll(".js-loading-indicator").hide()},select:function select(t,e){if(e.item.value)return value=e.item.value,label=e.item.label,Number.isInteger(value)&&(addTag(this,value,label),makeWowheadLinks()),!1},minLength:1,delay:400})})}function addItemListSelectHandler(){$(".js-input-item").change(function(){$(this).find(":selected").val(),$(this).find(":selected").html().trim(),value=$(this).find(":selected").val(),label=$(this).find(":selected").html().trim(),$nextInput=$(this).next("ul").children("li").children("input[value='']").first(),""==$nextInput.val()?($nextInput.parent("li").show(),$nextInput.val(value),$nextInput.siblings("input[value='']").first().val(label),$nextInput.siblings(".js-input-label").html(" "+label),$(this).val(""),$(this).find("option:first").text("—")):($(this).val(""),$(this).find("option:first").text("maximum added"))}),$(".js-input-select").change(function(){$(this).find(":selected").val(),$(this).find(":selected").html().trim(),value=$(this).find(":selected").val(),label=$(this).find(":selected").html().trim(),$nextInput=$(this).parent().next("ol").children("li").children("input[value='']").first(),""==$nextInput.val()?($nextInput.parent("li").show(),$nextInput.val(value),$nextInput.siblings(".js-input-label").html(" "+label),$label=$nextInput.next("input").first(),$label.val(label),$(this).val(""),$(this).find("option:first").text("—")):($(this).val(""),$(this).find("option:first").text("maximum added"))})}function addTagInputHandlers(){$(".js-item-autocomplete").keyup(function(t){keys=[13],$.inArray(t.keyCode,keys)>=0&&(t.preventDefault(),value=this.value,label=value,Number.isInteger(value)&&(addTag(this,value,label),makeWowheadLinks()))}),$(".js-item-autocomplete").focusout(function(){$(this).val()&&(value=this.value,label=value,Number.isInteger(value)&&(addTag(this,value,label),makeWowheadLinks()))})}function addItemRemoveHandler(){$(".js-input-button").click(function(){$(this).prev("input").val(""),$(this).prev("input").prev("input").val(""),$(this).parent("li").hide();var t=$(this).parent("li").parent("ul").siblings(".js-input-select");t.find("option:first").text("—"),t.show();var e=$(this).parent("li").parent("ul").siblings(".js-input-text");e.val()&&e.val().match("^maximum")&&e.val().match("added$")&&e.val(""),e.show()})}function addTag(t,e,n){if(t&&e){if(n||(n=""),$nextInput=$(t).next().next("ul").children("li").children("input[value='']").first(),""==$nextInput.val()){$nextInput.parent("li").show(),$nextInput.val(e),$nextInput.siblings("input[value='']").first().val(n);var a="";if(guild){var i='data-wowhead-link="https://'.concat(wowheadSubdomain,".wowhead.com/item=").concat(e,'"\n                        data-wowhead="item=').concat(e,"?domain=").concat(wowheadSubdomain,'"');a=' <a href="/'.concat(guild.id,"/").concat(guild.slug,"/i/").concat(e,"/").concat(slug(n),'"\n                    target="_blank"\n                    class="font-weight-medium"\n                    ').concat(i,">\n                    ").concat(n,"\n                </a>")}else a='<a href="https://'.concat(wowheadSubdomain,".wowhead.com/item=").concat(e,'" target="_blank" class="font-weight-medium">').concat(n,"</a>");return $nextInput.siblings(".js-input-label").html(a),$(t).val(""),$(t).data("isSingleInput")&&$(t).hide(),!0}return $(t).val("maximum items added"),!1}}$(document).ready(function(){addItemAutocompleteHandler(),addItemListSelectHandler(),addItemRemoveHandler(),addTagInputHandlers(),$(".js-sortable").sortable({handle:".js-sort-handle"}),$(".js-sortable-lazy").one("mouseenter",function(){$(this).sortable({handle:".js-sort-handle"})})});
