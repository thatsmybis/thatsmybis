function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t)){for(var a=0,e=new Array(t.length);a<t.length;a++)e[a]=t[a];return e}}function _slicedToArray(t,a){return _arrayWithHoles(t)||_iterableToArrayLimit(t,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,a){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var e=[],n=!0,r=!1,o=void 0;try{for(var c=t[Symbol.iterator](),l;!(n=(l=c.next()).done)&&(e.push(l.value),!a||e.length!==a);n=!0);}catch(t){r=!0,o=t}finally{try{n||null==c.return||c.return()}finally{if(r)throw o}}return e}}function _arrayWithHoles(t){if(Array.isArray(t))return t}var WARCRAFTLOGS_MODE_NEW="getNew",WARCRAFTLOGS_MODE_EXISTING="getExisting";function getWarcraftlogsRankedCharacters(t,a){var e=$("[name^=logs]:visible"),n=[];e.each(function(){$(this).val()&&(log=new URL($(this).val()),log.pathname.split("/").forEach(function(t){16!==t.length||n.push(t)}))}),$(".js-warcraftlogs-attendees-loading-spinner").show(),$("#warcraftlogsLoadingbar").addClass("d-flex").show(),$.ajax({method:"get",data:{codes:n,guild_id:guild.id},dataType:"json",url:"/api/warcraftlogs/attendees",success:function success(e){if($("#warcraftlogsLoadingbar").removeClass("d-flex").hide(),e.length<=0)$(".js-warcraftlogs-attendees-message").html("No attendance data found").show(),setTimeout(function(){return $(".js-warcraftlogs-attendees-message").hide()},7500);else{for(var n=[],r="Received the following from Warcraft Logs:",o=0,c=Object.entries(e);o<c.length;o++){var l=_slicedToArray(c[o],2),s=l[0],i=l[1];if(console.log("Report ".concat(i.code,":"),i),i.rankedCharacters)for(var d=function _loop(){var t=_slicedToArray(g[u],2),a=t[0],e=t[1];n.find(function(t){return t[0]===e.name})||n.push([e.name?e.name:"unknown",e])},u=0,g=Object.entries(i.rankedCharacters);u<g.length;u++)d();r+='<ul class="mt-3">\n                        <li class="font-weight-bold">\n                            '.concat(i.title,"\n                        </li>\n                        <li>\n                            ").concat(i.rankedCharacters?"".concat(i.rankedCharacters.length," characters"):"0 characters","\n                        </li>\n                        ").concat(i.endTime?'<li class="small text-muted font-weight-normal">'.concat(moment.utc(i.endTime).local().format("ddd, MMM Do YYYY @ h:mm a"),"</li>"):"","\n                        ").concat(i.zone&&i.zone.name?'<li class="small text-muted font-weight-normal">'.concat(i.zone.name,"</li>"):"",'\n                        <li class="small text-muted font-weight-normal">\n                            ID ').concat(i.code,"\n                        </li>\n                    </ul>")}printWarcraftlogsRankedCharacters(n,t,a,r)}},error:function error(t){}})}function getWarcraftlogsCharacterHtml(t){return'<span class="text-'.concat(t.classID&&WARCRAFTLOGS_CLASSES[t.classID]?WARCRAFTLOGS_CLASSES[t.classID].slug:"",'" title="').concat(t.classID&&WARCRAFTLOGS_CLASSES[t.classID]?WARCRAFTLOGS_CLASSES[t.classID].name:"",'">').concat(t.name,"</span>")}function printWarcraftlogsRankedCharacters(t,a,e){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=[],o=[],c=0,l=0;t.sort(function(t,a){return t[0]>a[0]}),t.forEach(function(t){t=t[1];var n=characters.find(function(a){return a.name===t.name});"getExisting"===e?n?a(n)&&(c++,r=[].concat(_toConsumableArray(r),[getWarcraftlogsCharacterHtml(t)])):o=[].concat(_toConsumableArray(o),[getWarcraftlogsCharacterHtml(t)]):"getNew"===e&&(n?o=[].concat(_toConsumableArray(o),[getWarcraftlogsCharacterHtml(t)]):a(t)&&(c++,r=[].concat(_toConsumableArray(r),[getWarcraftlogsCharacterHtml(t)]))),i++}),n+="<ul>\n        <li>".concat(c," added</li>\n        ").concat(r.length?'<li class="text-white"><span class="font-weight-bold">Successful:</span> '.concat(r.join(", "),"</li>"):"","\n        ").concat(o.length?'<li class="text-white">\n                    <span class="font-weight-bold">'.concat("getExisting"===e?"Not found:":"Already exists:","</span> ").concat(o.join(", "),"\n                </li>\n                ").concat("getExisting"===e?'<li class="text-white">To add these characters, add them to the guild and reload this page</li>':""):"","\n    </ul>"),$(".js-warcraftlogs-attendees-message").html(n).show(),addTooltips()}
