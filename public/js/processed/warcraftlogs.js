function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _slicedToArray(t,a){return _arrayWithHoles(t)||_iterableToArrayLimit(t,a)||_unsupportedIterableToArray(t,a)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,a){if(t){if("string"==typeof t)return _arrayLikeToArray(t,a);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,a):void 0}}function _arrayLikeToArray(t,a){(null==a||a>t.length)&&(a=t.length);for(var e=0,r=new Array(a);e<a;e++)r[e]=t[e];return r}function _iterableToArrayLimit(t,a){var e=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=e){var r,n,o,l,s=[],c=!0,i=!1;try{if(o=(e=e.call(t)).next,0===a){if(Object(e)!==e)return;c=!1}else for(;!(c=(r=o.call(e)).done)&&(s.push(r.value),s.length!==a);c=!0);}catch(t){i=!0,n=t}finally{try{if(!c&&null!=e.return&&(l=e.return(),Object(l)!==l))return}finally{if(i)throw n}}return s}}function _arrayWithHoles(t){if(Array.isArray(t))return t}var WARCRAFTLOGS_MODE_NEW="getNew",WARCRAFTLOGS_MODE_EXISTING="getExisting";function getWarcraftlogsRankedCharacters(t,a){var e=$("[name^=logs]:visible"),r=[];e.each(function(){$(this).val()&&(log=new URL($(this).val()),log.pathname.split("/").forEach(function(t){16!==t.length||r.push(t)}))}),$(".js-warcraftlogs-attendees-loading-spinner").show(),$("#warcraftlogsLoadingbar").addClass("d-flex").show();var n=!1;$.ajax({method:"get",data:{codes:r,guild_id:guild.id},dataType:"json",url:"/api/warcraftlogs/attendees",success:function success(e){if($("#warcraftlogsLoadingbar").removeClass("d-flex").hide(),e.length<=0)$(".js-warcraftlogs-attendees-message").html("No attendance data found").show(),setTimeout(function(){return $(".js-warcraftlogs-attendees-message").hide()},7500);else{for(var r=[],n="Received the following from Warcraft Logs:",o=0,l=Object.entries(e);o<l.length;o++){var s=_slicedToArray(l[o],2),c=s[0],i=s[1];if(i){if(console.log("Report ".concat(i.code,":"),i),i.rankedCharacters)for(var u=function _loop(){var t=_slicedToArray(f[d],2),a=t[0],e=t[1];r.find(function(t){return t[0]===e.name})||r.push([e.name?e.name:"unknown",e])},d=0,f=Object.entries(i.rankedCharacters);d<f.length;d++)u();n+='<ul class="mt-3">\n                            <li class="font-weight-bold">\n                                '.concat(i.title,"\n                            </li>\n                            <li>\n                                ").concat(i.rankedCharacters?"".concat(i.rankedCharacters.length," characters"):"0 characters","\n                            </li>\n                            ").concat(i.endTime?'<li class="small text-muted font-weight-normal">'.concat(moment.utc(i.endTime).local().format("ddd, MMM Do YYYY @ h:mm a"),"</li>"):"","\n                            ").concat(i.zone&&i.zone.name?'<li class="small text-muted font-weight-normal">'.concat(i.zone.name,"</li>"):"",'\n                            <li class="small text-muted font-weight-normal">\n                                ID ').concat(i.code,"\n                            </li>\n                        </ul>")}else console.log("No report found"),n+='<ul class="mt-3">\n                            <li class="font-weight-bold text-danger">\n                                No report found. Did you connect your Warcraftlogs account in guild settings?\n                            </li>\n                        </ul>'}printWarcraftlogsRankedCharacters(r,t,a,n)}},error:function error(t){console.log("error")}})}function getWarcraftlogsCharacterHtml(t){return'<span class="text-'.concat(t.classID&&WARCRAFTLOGS_CLASSES[t.classID]?WARCRAFTLOGS_CLASSES[t.classID].slug:"",'" title="').concat(t.classID&&WARCRAFTLOGS_CLASSES[t.classID]?WARCRAFTLOGS_CLASSES[t.classID].name:"",'">').concat(t.name,"</span>")}function printWarcraftlogsRankedCharacters(t,a,e){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",n=[],o=[],l=0,s=0;t.sort(function(t,a){return t[0]>a[0]}),t.forEach(function(t){t=t[1];var r=characters.find(function(a){return a.name.toLowerCase()===t.name.toLowerCase()});"getExisting"===e?r?a(r)&&(l++,n=[].concat(_toConsumableArray(n),[getWarcraftlogsCharacterHtml(t)])):o=[].concat(_toConsumableArray(o),[getWarcraftlogsCharacterHtml(t)]):"getNew"===e&&(r?o=[].concat(_toConsumableArray(o),[getWarcraftlogsCharacterHtml(t)]):a(t)&&(l++,n=[].concat(_toConsumableArray(n),[getWarcraftlogsCharacterHtml(t)]))),i++}),r+="<ul>\n        <li>".concat(l," added</li>\n        ").concat(n.length?'<li class="text-white"><span class="font-weight-bold">Successful:</span> '.concat(n.join(", "),"</li>"):"","\n        ").concat(o.length?'<li class="text-white">\n                    <span class="font-weight-bold">'.concat("getExisting"===e?"Not found:":"Already exists:","</span> ").concat(o.join(", "),"\n                </li>\n                ").concat("getExisting"===e?'<li class="text-white">To add these characters, add them to the guild and reload this page</li>':""):"","\n    </ul>"),$(".js-warcraftlogs-attendees-message").html(r).show(),addTooltips()}
